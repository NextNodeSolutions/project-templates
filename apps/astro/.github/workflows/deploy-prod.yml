name: Deploy to Production

on:
  push:
    branches: [main, master]
  workflow_dispatch:
    inputs:
      branch:
        description: 'Branch to deploy from'
        required: false
        default: 'main'
        type: choice
        options:
          - main
          - master

jobs:
  deploy:
    name: Deploy
    # Skip first commit to avoid deployment during initial setup
    if: github.run_number > 1
    uses: NextNodeSolutions/github-actions/.github/workflows/deploy.yml@main
    with:
      service-name: '{{project_name}}'
      domain: '{{website_url}}'
      environment: 'production'
      pnpm-version: '10.12.4'
      checkout-ref: ${{ github.event.inputs.branch || 'main' }}
    secrets: inherit